import{i as ye,s as be,c as B,a as He,j as c,F as G,G as P,b as Oe,B as ke,p as l,R as V,d as T,e as we,Q as Be,u as Ke,f as Se,g as Ge,r as je,l as qe,T as ie,h as ae,L as Qe,k as Ve,_ as Xe}from"./RumbleLoader.629b51c9.js";import{A as Ue,G as Ye,a as Je}from"./Grid.91185de4.js";class oe extends Map{constructor(i,t=et){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),i!=null)for(const[r,n]of i)this.set(r,n)}get(i){return super.get(le(this,i))}has(i){return super.has(le(this,i))}set(i,t){return super.set(Ze(this,i),t)}delete(i){return super.delete(_e(this,i))}}function le({_intern:e,_key:i},t){const r=i(t);return e.has(r)?e.get(r):t}function Ze({_intern:e,_key:i},t){const r=i(t);return e.has(r)?e.get(r):(e.set(r,t),t)}function _e({_intern:e,_key:i},t){const r=i(t);return e.has(r)&&(t=e.get(r),e.delete(r)),t}function et(e){return e!==null&&typeof e=="object"?e.valueOf():e}function tt(e,i,t){e=+e,i=+i,t=(n=arguments.length)<2?(i=e,e=0,1):n<3?1:+t;for(var r=-1,n=Math.max(0,Math.ceil((i-e)/t))|0,a=new Array(n);++r<n;)a[r]=e+r*t;return a}const se=Symbol("implicit");function Z(){var e=new oe,i=[],t=[],r=se;function n(a){let s=e.get(a);if(s===void 0){if(r!==se)return r;e.set(a,s=i.push(a)-1)}return t[s%t.length]}return n.domain=function(a){if(!arguments.length)return i.slice();i=[],e=new oe;for(const s of a)e.has(s)||e.set(s,i.push(s)-1);return n},n.range=function(a){return arguments.length?(t=Array.from(a),n):t.slice()},n.unknown=function(a){return arguments.length?(r=a,n):r},n.copy=function(){return Z(i,t).unknown(r)},ye.apply(n,arguments),n}function Te(){var e=Z().unknown(void 0),i=e.domain,t=e.range,r=0,n=1,a,s,o=!1,u=0,d=0,f=.5;delete e.unknown;function h(){var p=i().length,y=n<r,x=y?n:r,b=y?r:n;a=(b-x)/Math.max(1,p-u+d*2),o&&(a=Math.floor(a)),x+=(b-x-a*(p-u))*f,s=a*(1-u),o&&(x=Math.round(x),s=Math.round(s));var k=tt(p).map(function(O){return x+a*O});return t(y?k.reverse():k)}return e.domain=function(p){return arguments.length?(i(p),h()):i()},e.range=function(p){return arguments.length?([r,n]=p,r=+r,n=+n,h()):[r,n]},e.rangeRound=function(p){return[r,n]=p,r=+r,n=+n,o=!0,h()},e.bandwidth=function(){return s},e.step=function(){return a},e.round=function(p){return arguments.length?(o=!!p,h()):o},e.padding=function(p){return arguments.length?(u=Math.min(1,d=+p),h()):u},e.paddingInner=function(p){return arguments.length?(u=Math.min(1,p),h()):u},e.paddingOuter=function(p){return arguments.length?(d=+p,h()):d},e.align=function(p){return arguments.length?(f=Math.max(0,Math.min(1,p)),h()):f},e.copy=function(){return Te(i(),[r,n]).round(o).paddingInner(u).paddingOuter(d).align(f)},ye.apply(h(),arguments)}var nt=be("domain","range","reverse","align","padding","round");function rt(e){return nt(Te(),e)}var it=be("domain","range","reverse","unknown");function at(e){return it(Z(),e)}var ce=Array.prototype.slice;function z(e,i){if((s=e.length)>1)for(var t=1,r,n,a=e[i[0]],s,o=a.length;t<s;++t)for(n=a,a=e[i[t]],r=0;r<o;++r)a[r][1]+=a[r][0]=isNaN(n[r][1])?n[r][0]:n[r][1]}function A(e){for(var i=e.length,t=new Array(i);--i>=0;)t[i]=i;return t}function ot(e,i){return e[i]}function lt(){var e=B([]),i=A,t=z,r=ot;function n(a){var s=e.apply(this,arguments),o,u=a.length,d=s.length,f=new Array(d),h;for(o=0;o<d;++o){for(var p=s[o],y=f[o]=new Array(u),x=0,b;x<u;++x)y[x]=b=[0,+r(a[x],p,x,a)],b.data=a[x];y.key=p}for(o=0,h=i(f);o<d;++o)f[h[o]].index=o;return t(f,h),f}return n.keys=function(a){return arguments.length?(e=typeof a=="function"?a:B(ce.call(a)),n):e},n.value=function(a){return arguments.length?(r=typeof a=="function"?a:B(+a),n):r},n.order=function(a){return arguments.length?(i=a==null?A:typeof a=="function"?a:B(ce.call(a)),n):i},n.offset=function(a){return arguments.length?(t=a==null?z:a,n):t},n}function st(e,i){if((r=e.length)>0){for(var t,r,n=0,a=e[0].length,s;n<a;++n){for(s=t=0;t<r;++t)s+=e[t][n][1]||0;if(s)for(t=0;t<r;++t)e[t][n][1]/=s}z(e,i)}}function ct(e,i){if((u=e.length)>0)for(var t,r=0,n,a,s,o,u,d=e[i[0]].length;r<d;++r)for(s=o=0,t=0;t<u;++t)(a=(n=e[i[t]][r])[1]-n[0])>0?(n[0]=s,n[1]=s+=a):a<0?(n[1]=o,n[0]=o+=a):(n[0]=0,n[1]=a)}function ut(e,i){if((n=e.length)>0){for(var t=0,r=e[i[0]],n,a=r.length;t<a;++t){for(var s=0,o=0;s<n;++s)o+=e[s][t][1]||0;r[t][1]+=r[t][0]=-o/2}z(e,i)}}function dt(e,i){if(!(!((s=e.length)>0)||!((a=(n=e[i[0]]).length)>0))){for(var t=0,r=1,n,a,s;r<a;++r){for(var o=0,u=0,d=0;o<s;++o){for(var f=e[i[o]],h=f[r][1]||0,p=f[r-1][1]||0,y=(h-p)/2,x=0;x<o;++x){var b=e[i[x]],k=b[r][1]||0,O=b[r-1][1]||0;y+=k-O}u+=h,d+=y*h}n[r-1][1]+=n[r-1][0]=t,u&&(t-=d/u)}n[r-1][1]+=n[r-1][0]=t,z(e,i)}}function ht(e){var i=e.map(pt);return A(e).sort(function(t,r){return i[t]-i[r]})}function pt(e){for(var i=-1,t=0,r=e.length,n,a=-1/0;++i<r;)(n=+e[i][1])>a&&(a=n,t=i);return t}function Ce(e){var i=e.map(Me);return A(e).sort(function(t,r){return i[t]-i[r]})}function Me(e){for(var i=0,t=-1,r=e.length,n;++t<r;)(n=+e[t][1])&&(i+=n);return i}function ft(e){return Ce(e).reverse()}function gt(e){var i=e.length,t,r,n=e.map(Me),a=ht(e),s=0,o=0,u=[],d=[];for(t=0;t<i;++t)r=a[t],s<o?(s+=n[r],u.push(r)):(o+=n[r],d.push(r));return d.reverse().concat(u)}function mt(e){return A(e).reverse()}var ue={ascending:Ce,descending:ft,insideout:gt,none:A,reverse:mt};function xt(e){return e&&ue[e]||ue.none}var de={expand:st,diverging:ct,none:z,silhouette:ut,wiggle:dt};function vt(e){return e&&de[e]||de.none}function yt(e){if("bandwidth"in e)return e.bandwidth();var i=e.range(),t=e.domain();return Math.abs(i[i.length-1]-i[0])/t.length}function bt(e){return e==null?void 0:e[0]}function Ot(e){return e==null?void 0:e[1]}var kt=["data","className","top","left","x","y0","y1","xScale","yScale","color","keys","value","order","offset","children"];function wt(e,i){if(e==null)return{};var t={},r=Object.keys(e),n,a;for(a=0;a<r.length;a++)n=r[a],!(i.indexOf(n)>=0)&&(t[n]=e[n]);return t}function St(e){var i=e.data,t=e.className,r=e.top,n=e.left,a=e.x,s=e.y0,o=s===void 0?bt:s,u=e.y1,d=u===void 0?Ot:u,f=e.xScale,h=e.yScale,p=e.color,y=e.keys,x=e.value,b=e.order,k=e.offset,O=e.children,R=wt(e,kt),C=lt();y&&C.keys(y),x&&He(C.value,x),b&&C.order(xt(b)),k&&C.offset(vt(k));var I=C(i),L=yt(f),m=I.map(function(g,v){var $=g.key;return{index:v,key:$,bars:g.map(function(w,S){var M=(h(o(w))||0)-(h(d(w))||0),N=h(d(w)),F="bandwidth"in f?f(a(w.data)):Math.max((f(a(w.data))||0)-L/2);return{bar:w,key:$,index:S,height:M,width:L,x:F||0,y:N||0,color:p(g.key,S)}})}});return O?c(G,{children:O(m)}):c(P,{className:Oe("visx-bar-stack",t),top:r,left:n,children:m.map(function(g){return g.bars.map(function(v){return c(ke,{x:v.x,y:v.y,height:v.height,width:v.width,fill:v.color,...R},"bar-stack-"+g.index+"-"+v.index)})})})}var Tt=["flexDirection","alignItems","margin","display","children"];function Ct(e,i){if(e==null)return{};var t={},r=Object.keys(e),n,a;for(a=0;a<r.length;a++)n=r[a],!(i.indexOf(n)>=0)&&(t[n]=e[n]);return t}function $e(e){var i=e.flexDirection,t=i===void 0?"row":i,r=e.alignItems,n=r===void 0?"center":r,a=e.margin,s=a===void 0?"0":a,o=e.display,u=o===void 0?"flex":o,d=e.children,f=Ct(e,Tt);return c("div",{className:"visx-legend-item",style:{display:u,alignItems:n,flexDirection:t,margin:s},...f,children:d})}$e.propTypes={alignItems:l.exports.string,margin:l.exports.oneOfType([l.exports.string,l.exports.number]),children:l.exports.node,display:l.exports.string};var Mt=["flex","label","margin","align","children"];function $t(e,i){if(e==null)return{};var t={},r=Object.keys(e),n,a;for(a=0;a<r.length;a++)n=r[a],!(i.indexOf(n)>=0)&&(t[n]=e[n]);return t}function Le(e){var i=e.flex,t=i===void 0?"1":i,r=e.label,n=e.margin,a=n===void 0?"5px 0":n,s=e.align,o=s===void 0?"left":s,u=e.children,d=$t(e,Mt);return c("div",{className:"visx-legend-label",style:{justifyContent:o,display:"flex",flex:t,margin:a},...d,children:u||r})}Le.propTypes={align:l.exports.string,label:l.exports.node,flex:l.exports.oneOfType([l.exports.string,l.exports.number]),margin:l.exports.oneOfType([l.exports.string,l.exports.number]),children:l.exports.node};function U(){return U=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},U.apply(this,arguments)}function _(e){var i=e.fill,t=e.width,r=e.height,n=e.style;return c("div",{style:U({width:t,height:r,background:i},n)})}_.propTypes={fill:l.exports.string,width:l.exports.oneOfType([l.exports.string,l.exports.number]),height:l.exports.oneOfType([l.exports.string,l.exports.number])};function Ie(e){var i=e.fill,t=e.width,r=e.height,n=e.style,a=typeof t=="string"||typeof t>"u"?0:t,s=typeof r=="string"||typeof r>"u"?0:r,o=Math.max(a,s),u=o/2;return c("svg",{width:o,height:o,children:c(P,{top:u,left:u,children:c("circle",{r:u,fill:i,style:n})})})}Ie.propTypes={fill:l.exports.string,width:l.exports.oneOfType([l.exports.string,l.exports.number]),height:l.exports.oneOfType([l.exports.string,l.exports.number])};function Fe(e){var i=e.fill,t=e.width,r=e.height,n=e.style,a=typeof r=="string"||typeof r>"u"?0:r,s=typeof(n==null?void 0:n.strokeWidth)=="number"?n==null?void 0:n.strokeWidth:2;return c("svg",{width:t,height:r,children:c(P,{top:a/2-s/2,children:c("line",{x1:0,x2:t,y1:0,y2:0,stroke:i,strokeWidth:s,style:n})})})}Fe.propTypes={fill:l.exports.string,width:l.exports.oneOfType([l.exports.string,l.exports.number]),height:l.exports.oneOfType([l.exports.string,l.exports.number])};function E(){return E=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},E.apply(this,arguments)}var X=function(){};function Lt(e){var i=e.shape,t=i===void 0?"rect":i,r=e.fill,n=r===void 0?X:r,a=e.size,s=a===void 0?X:a,o=e.width,u=e.height,d=e.label,f=e.item,h=e.itemIndex,p=e.shapeStyle,y=p===void 0?X:p,x={width:o,height:u,item:f,itemIndex:h,label:d,fill:n(E({},d)),size:s(E({},d)),style:y(E({},d))};return typeof t=="string"?t==="circle"?c(Ie,{...x}):t==="line"?c(Fe,{...x}):c(_,{...x}):V.isValidElement(t)?V.cloneElement(t,x):t?V.createElement(t,x):null}function j(){return j=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},j.apply(this,arguments)}function De(e){var i=e.shape,t=i===void 0?_:i,r=e.width,n=e.height,a=e.margin,s=e.label,o=e.item,u=e.itemIndex,d=e.fill,f=e.size,h=e.shapeStyle;return c("div",{className:"visx-legend-shape",style:{display:"flex",width:f?f(j({},s)):r,height:f?f(j({},s)):n,margin:a},children:Lt({shape:t,item:o,itemIndex:u,label:s,width:r,height:n,fill:d,shapeStyle:h})})}De.propTypes={itemIndex:l.exports.number.isRequired,margin:l.exports.oneOfType([l.exports.string,l.exports.number]),width:l.exports.oneOfType([l.exports.string,l.exports.number]),height:l.exports.oneOfType([l.exports.string,l.exports.number])};function Pe(e){return e&&typeof e=="object"&&"value"in e&&typeof e.value<"u"?e.value:e}function he(e){return String(Pe(e))}function It(e){var i=e.scale,t=e.labelFormat;return function(r,n){return{datum:r,index:n,text:""+t(r,n),value:i(r)}}}var Ft=["className","style","scale","shape","domain","fill","size","labelFormat","labelTransform","shapeWidth","shapeHeight","shapeMargin","shapeStyle","labelAlign","labelFlex","labelMargin","itemMargin","direction","itemDirection","legendLabelProps","children"];function Y(){return Y=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},Y.apply(this,arguments)}function Dt(e,i){if(e==null)return{};var t={},r=Object.keys(e),n,a;for(a=0;a<r.length;a++)n=r[a],!(i.indexOf(n)>=0)&&(t[n]=e[n]);return t}var Pt={display:"flex"};function ze(e){var i=e.className,t=e.style,r=t===void 0?Pt:t,n=e.scale,a=e.shape,s=e.domain,o=e.fill,u=o===void 0?he:o,d=e.size,f=d===void 0?he:d,h=e.labelFormat,p=h===void 0?Pe:h,y=e.labelTransform,x=y===void 0?It:y,b=e.shapeWidth,k=b===void 0?15:b,O=e.shapeHeight,R=O===void 0?15:O,C=e.shapeMargin,I=C===void 0?"2px 4px 2px 0":C,L=e.shapeStyle,m=e.labelAlign,g=m===void 0?"left":m,v=e.labelFlex,$=v===void 0?"1":v,w=e.labelMargin,S=w===void 0?"0 4px":w,M=e.itemMargin,N=M===void 0?"0":M,F=e.direction,H=F===void 0?"column":F,ee=e.itemDirection,Re=ee===void 0?"row":ee,Ne=e.legendLabelProps,te=e.children,We=Dt(e,Ft),ne=s||("domain"in n?n.domain():[]),Ee=x({scale:n,labelFormat:p}),re=ne.map(Ee);return te?c(G,{children:te(re)}):c("div",{className:Oe("visx-legend",i),style:Y({},r,{flexDirection:H}),children:re.map(function(q,Q){return T($e,{margin:N,flexDirection:Re,...We,children:[c(De,{shape:a,height:R,width:k,margin:I,item:ne[Q],itemIndex:Q,label:q,fill:u,size:f,shapeStyle:L}),c(Le,{label:q.text,flex:$,margin:S,align:g,...Ne})]},"legend-"+q.text+"-"+Q)})})}ze.propTypes={children:l.exports.func,className:l.exports.string,domain:l.exports.array,shapeWidth:l.exports.oneOfType([l.exports.string,l.exports.number]),shapeHeight:l.exports.oneOfType([l.exports.string,l.exports.number]),shapeMargin:l.exports.oneOfType([l.exports.string,l.exports.number]),labelAlign:l.exports.string,labelFlex:l.exports.oneOfType([l.exports.string,l.exports.number]),labelMargin:l.exports.oneOfType([l.exports.string,l.exports.number]),itemMargin:l.exports.oneOfType([l.exports.string,l.exports.number]),fill:l.exports.func,size:l.exports.func,shapeStyle:l.exports.func};function zt(e){return c(ze,{...e})}const pe="#8C8C8C",At="#16C0D7",Rt="#1F2892",Nt="#3443F4",Wt="#F236F6",fe="#383838",Et="#808080",Ht={top:60,right:40,bottom:60,left:40},Ae=new URLSearchParams(window.location.search);var xe;const D=(xe=Ae.get("left"))!=null?xe:"nginx:latest";var ve;const W=(ve=Ae.get("right"))!=null?ve:"cgr.dev/chainguard/nginx:latest",ge={...we,textAlign:"center",transform:"translateX(-50%)",fontSize:18,background:"none",top:0,color:"#8C8C8C",zIndex:1e3},me={...we},Bt={background:"#ffffff",position:"relative"},Kt={background:"#040404",position:"relative"};var J=localStorage.getItem("theme")||"dark";window.addEventListener("message",e=>{e.data.colorscheme=="light"?J="light":e.data.colorscheme=="dark"&&(J="dark")});const K=["unknown","low","medium","high","critical"],Gt=e=>Se(e.date);function jt(e){return c(Be,{keys:[D,W],children:i=>c(qt,{query:i,...e})})}function qt({width:e,height:i,query:{data:t,scanner:r},margin:n=Ht}){var I,L;const{tooltipOpen:a,tooltipLeft:s,tooltipData:o,hideTooltip:u,showTooltip:d}=Ke(),f=rt({domain:Object.values(t[D]).map(m=>Se(m.date)),padding:.1}),h=Ge({domain:[0,Math.max(...Object.values(t[D]).map(m=>m.totalCveCount),...Object.values(t[W]).map(m=>m.totalCveCount))+1],nice:!0}),p=at({domain:[...K],range:[pe,At,Rt,Nt,Wt]}),y=je.exports.useCallback(m=>{var H;const g=f;let{x:v}=qe(m)||{x:0};v-=n.left,v>g.range()[1]&&(v-=g.range()[1],v-=k);const $=g.step(),w=g.domain(),S=(g.range()[1]-$*w.length)/2,M=g.domain()[Math.floor((v-S)/$)];if(!M)return;const N=t[D][M],F=t[W][M];d({tooltipData:{formattedDate:M,dataLeft:N,dataRight:F},tooltipLeft:((H=g(M))!=null?H:0)+g.bandwidth()/2,tooltipTop:n.top})},[n,t]),x=e-n.left-n.right,b=i-n.top-n.bottom,k=20,O=(x-k)/2;if(f.range([0,O]),h.range([b,0]),e<10)return null;function R(){return J=="light"?Bt:Kt}function C({data:m,tooltipData:g}){var v;return T(G,{children:[c(Ye,{xScale:f,yScale:h,width:O,height:b,stroke:"#8C8C8C",strokeOpacity:.25}),c(ke,{width:O,height:b,fill:"transparent",onTouchStart:y,onTouchMove:y,onMouseMove:y}),c(St,{data:m,keys:[...K],x:Gt,xScale:f,yScale:h,color:p,children:$=>$.map(w=>w.bars.map(S=>c("rect",{x:S.x,y:S.y,height:S.height,width:S.width,fill:S.color,onMouseMove:y},`bar-stack-${w.index}-${S.index}`)))}),c(Je,{top:b,scale:f,stroke:fe,tickStroke:fe,numTicks:6,tickLabelProps:()=>({fill:"#8C8C8C",fontSize:11,textAnchor:"middle"})}),a&&g&&T("g",{children:[c(Qe,{from:{x:s,y:0},to:{x:s,y:b},stroke:Et,strokeWidth:2,pointerEvents:"none",strokeDasharray:"5,2"}),c("circle",{cx:s,cy:h((v=g.totalCveCount)!=null?v:0),r:6,fill:pe,stroke:"white",strokeWidth:3,pointerEvents:"none"})]})]})}return T("div",{style:R(),children:[T("svg",{width:e,height:i,fill:"none",children:[c("rect",{x:0,y:0,width:e,height:i}),c(P,{top:n.top,left:n.left,children:c(C,{data:Object.values(t[D]),tooltipData:o==null?void 0:o.dataLeft})}),c(P,{top:n.top,left:n.left+O+k,children:c(C,{data:Object.values(t[W]),tooltipData:o==null?void 0:o.dataRight})}),c(P,{left:n.left,top:n.top,children:c(Ue,{scale:h,tickFormat:m=>m.toString(),stroke:"#8C8C8C",tickStroke:"#8C8C8C",tickLabelProps:()=>({fill:"#8C8C8C",fontSize:11,textAnchor:"end",dx:"-0.5em",dy:"0.33em"})})})]}),a&&o&&T(G,{children:[o.dataLeft&&c(ie,{top:h((I=o.dataLeft.totalCveCount)!=null?I:0)+n.top,left:(s!=null?s:0)+12,style:me,children:T("div",{style:{display:"flex",flexDirection:"column"},children:[c("div",{children:c("small",{children:o.formattedDate})}),T("div",{children:["Total: ",(L=o.dataLeft.totalCveCount)!=null?L:0]}),K.filter(m=>{var g,v;return((v=(g=o.dataLeft)==null?void 0:g[m])!=null?v:0)>0}).map(m=>{var g;return T("div",{style:{color:p(m)},children:[m,": ",(g=o.dataLeft)==null?void 0:g[m]]},m)})]})},Math.random()),o.dataRight&&c(ie,{top:h(o.dataRight.totalCveCount)+n.top,left:(s!=null?s:0)+k+O+12,style:me,children:T("div",{style:{display:"flex",flexDirection:"column"},children:[c("div",{children:c("small",{children:o.formattedDate})}),T("div",{children:["Total: ",o.dataRight.totalCveCount]}),K.filter(m=>{var g,v;return((v=(g=o.dataRight)==null?void 0:g[m])!=null?v:0)>0}).map(m=>{var g;return T("div",{style:{color:p(m)},children:[m,": ",(g=o.dataRight)==null?void 0:g[m]]},m)})]})},Math.random())]}),c(ae,{top:n.top-25,left:n.left+O/2,style:ge,children:D.split("@")[0]}),c(ae,{top:n.top-25,left:n.left+k+O+O/2,style:ge,children:W.split("@")[0]}),c("div",{style:{position:"fixed",bottom:0,width:"100%",display:"flex",justifyContent:"center"},children:c(zt,{scale:p,direction:"row",legendLabelProps:{style:{textTransform:"capitalize",margin:"0 15px 0 0",color:"#8C8C8C"}}})})]})}Ve.createRoot(document.getElementById("root")).render(c(Xe,{debounceTime:50,children:({width:e,height:i})=>c(jt,{width:e,height:i})}));
