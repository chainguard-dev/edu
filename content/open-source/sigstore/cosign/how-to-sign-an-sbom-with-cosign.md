---
title: "How to Sign an SBOM with Cosign"
type: "article"
description: "Signing software bills of materials with Cosign"
lead: "Use Cosign to sign software bills of materials (SBOMs)"
date: 2022-13-07T15:22:20+01:00
lastmod: 2024-07-29T15:12:18+00:00
draft: false
tags: ["Cosign", "Procedural", "SBOM"]
images: []
menu:
  docs:
    parent: "cosign"
weight: 005
toc: true
---

_An earlier version of this material was published in the [Cosign chapter](https://learning.edx.org/course/course-v1:LinuxFoundationX+LFS182x+2T2022/block-v1:LinuxFoundationX+LFS182x+2T2022+type@sequential+block@204b98f35bca48c194d1868e0356bef1/block-v1:LinuxFoundationX+LFS182x+2T2022+type@vertical+block@2f0ad9cb8f124a39ab555ac8bf1a114c) of the Linux Foundation [Sigstore course](https://learning.edx.org/course/course-v1:LinuxFoundationX+LFS182x+2T2022/home)._

[Cosign](https://github.com/sigstore/cosign), developed as part of the [Sigstore project](https://www.sigstore.dev/), is a command line utility for signing, verifying, storing, and retrieving software artifacts through interface with an OCI (Open Container Initiative) registry. Cosign can be used to sign attestations, or a verifiable assertion or statement about a software artifact. 

{{< details "What is an Attestation?" >}}
{{< blurb/attestation >}}
{{< /details >}}

One common use case for attestations is associating a software artifact, such as an OCI container image, with a [software bill of materials (SBOM)](/open-source/sbom/what-is-an-sbom/)), an inventory of the components that make up a given software artifact. Increasingly, SBOMs are considered an essential component in ensuring a secure software supply chain.

{{< details "What is a Software Bill of Materials (SBOM?" >}}
{{< blurb/sbom >}}
{{< /details >}}

Including an SBOM with software you ship can help others trust the provenance and contents of the software. Including your SBOM as an attestation verifies that the SBOM was generated by the same trusted organization that created the software artifact, and that neither the artifact nor its associated metadata and documents have been tampered with.

In the following, we'll generate an SBOM and associate it with a specific OCI container using an attestation generated by Cosign.

## Creating a Demonstration Container

Since we'll be attaching an SBOM to a container image, we'll first need to create an example image. We'll base this image on Chainguard's [`wolfi-base`](https://edu.chainguard.dev/open-source/wolfi/overview), and add a single additional package, the venerable `cowsay` utility that prints a message along with some ASCII art. We then set the entrypoint so that, when the image is run, a message will be displayed.

Create a new folder for our Dockerfile build and change your workin directory to that folder:

```sh
mkdir -p ~/example-image && cd ~/example-image
```

Create a new `Dockerfile` in the folder using Nano or your preferred text editor:

```sh
nano Dockerfile
```
Paste the following commands into the file:

```sh

```Dockerfile
FROM cgr.dev/chainguard/wolfi-base
RUN apk add cowsay
ENTRYPOINT ["cowsay", "-f", "tux", "I love FOSS"]
```

Save the file and close Nano by pressing `Control-x`, `y`, and `Enter` in succession.

Finally, build and tag the image with:

```sh
docker build . -t example-image
```

You can test out the image by running it:

```sh
docker run example-image
```

## Generating an SBOM with Syft

[Syft](https://github.com/anchore/syft) is a tool that allows us to create SBOMs. If you don't already have Syft, use the instructions below to install this utility.

{{< details "How to Install Syft" >}}
{{< blurb/install_syft >}}
{{< /details >}}

Once you have Syft installed, you can generate an SBOM with the `syft` command, passing in the target image as an argument. For example, the following will use Syft to generate a list of packages presentin the official `python` image on Docker Hub:

```sh
syft python
```

Now let's generate an SBOM for `example-image`, the image we built in the previous section. Run the following Syft command to generate an SBOM in SPDX format

```sh
syft example-image:latest -o spdx > example_image.spdx
```
{{< details "What is SPDX?" >}}
{{< blurb/spdx >}}
{{< /details >}}

If you take a look at the contents of the file, you will find our installed package, `cowsay`, represented alongside the otherpackages already in our base image, `wolfi-base`. You can also check that `cowsay` is detected by Syft with the following:

```sh
syft --quiet example-image:latest | grep cowsay
```

```
cowsay                  3.04-r0       apk
```

In the next section, we'll associate this SBOM with our container image using Cosign.

## Attesting to the SBOM



## Sign the SBOM

You will sign the SBOM in a similar way to signing other software artifacts. 

Make sure you are in the correct local directory for your Cosign key pair. If you generated the key pair in the signed container example, it will be in your home user directory, so make sure you move your present working directory there with the `cd ~` command.

You’ll be signing the SBOM with the SHA that you received in the output from the previous command. This is a long string that starts with `sha256` and ends with `.sbom`. You can verify that this was pushed to the container registry by checking the web user interface of Docker Hub or alternate registry. 

We have an example SBOM SHA below, please use the SHA output you received.

```sh
cosign sign --key cosign.key docker-username/hello-container:sha256-690ecfd885f008330a66d08be13dc6c115a439e1cc935c04d181d7116e198f9c.sbom
```

Again, you’ll be prompted for the password for your Cosign private key. Once you enter the password, you’ll receive output that the signature was pushed to the registry.

```
Pushing signature to: index.docker.io/docker-username/hello-container
```

You can verify the signature on the SBOM as you can with any other signature.

```sh
cosign verify --key cosign.pub docker-username/hello-container:sha256-690ecfd885f008330a66d08be13dc6c115a439e1cc935c04d181d7116e198f9c.sbom
```

As before, you’ll receive output that the SBOM’s signature is verified and you’ll receive a JSON formatted digest of the information. 

You have now created and signed an SBOM for your container!
